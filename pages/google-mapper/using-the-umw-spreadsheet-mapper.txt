{{indexmenu_n>1}}

#Using the Spreadsheet Mapper

====Getting the Mapper Template====

1)  Go to [[http://drive.google.com|Google Drive]] and sign in with your Google username and password. If you don't already have a Google account, you will need to [[https://accounts.google.com/signup|create one]].

2)  From the Google Drive [[http://drive.google.com/templates|Templates gallery]], search for UMW, and find the Spreadsheet Mapper template your course is using. If there is not a customized template for your specific course, use the template called "UMW Spreadsheet Mapper." You can also find [[google-mapper:google-mapper|a list of customized templates]] on this wiki.

3)  Once you have found the right template, click the "Use this template" button, and the template will be copied into your Google Drive account. When it is done copying, the template will be opened in your browser and you can begin working immediately.

====Initial Setup====

1)  The template will automatically open to the MapMetaData tab. Change the information in the "Basic Information" section to describe the project you are working on.

2)  To make the data from this map accessible via the web, you will need to publish it. From the top menu, click File -> Publish to Web.

{{:google-mapper:file_publish_to_web.png?300|}}

3)  Another window will pop up. Uncheck the Automatically republish when changes are made box, and click Start Publishing now. 

4)  Remember, you will need to manually republish this spreadsheet after you make updates. You can do that by returning to this screen, and clicking the Republish now button.

====Entering Data====

1)  To begin entering data, click the tab along the bottom of the screen called PlacemarkData.

2)  This is the worksheet where all of the data for your map lives. Each row will create a single placemark (i.e. a point on your map). The data is broken down into two sections: static columns, and variable columns.

NOTE: To remove the sample placemarks, delete the content from each cell. DO NOT delete rows from the spreadsheet, as this will cause errors.

===Static Columns===

  * **Folder Name:** (optional) helps organize placemarks into a collapsible folder.
  * **Placemark Name:** the name of the place you are mapping.
  * **Latitude and Longitude:** the geolocation of the place you are mapping. You can find the coordinates for many places, especially those that are popular and/or of historical importance, through a simple Google search (e.g. "UMW coordinates").

NOTE: We highly recommend finding and entering the latitude and longitude for each placemark, instead of entering a street address. Using street addresses will make your map much slower to load, as the program will have to convert each of those addresses into geocoordinates (lat/long) every time the map is loaded. 

1) Right click on your place in google maps and then click “What's here?” in the pop up menu. Then it will display the Latitude and Longitude in the search bar at the top.

{{:google-mapper:latlng_marker_activated.png?300|}}

2) A the bottom of the left side white column there is a option called “Map Labs.” In here you can activate two tools that can help you find the latitude and longitude: “LatLng Tooltip” and “LatLng Marker.”

{{:google-mapper:map_labels.png?300|}} {{:google-mapper:enable_tools.png?300|}}



LatLng Tool Tip: Enable the tool in the “Map Labs” menu and hold shift to display the latitude and Longitude.

{{:google-mapper:latlng_tooltip_activated.png?300|}}

LatLng Marker: Enable the tool in the “Map Labs” menu, the in google maps when you find your point, right click, and in the menu click “Drop LatLng marker.”

{{:google-mapper:right_click_drop_lantlng_marker.png?300|}}

You will need to convert your latitude and longitude to a standard format of XX.XXXX. The degrees, then hours, and then minutes need to be a displayed as a decimal.

Also you will need to manually convert the decimal to the appropriate quadrant since the spreadsheet cannot not see and convert the cardinal directions (N,S,E,W). North and East are positive and South and West become negative numbers. Refer to the image below for help.

{{:google-mapper:coordinates_explination.png?800|}}

**Address:** Do not use this column, the functionality is poor and it will adversely affect your map.

These columns will appear on the left side of the screen like this:

{{:google-mapper:first_set_of_colums.png?200|}}

These Columns, as pictured below change what inputs need and to be entered into the respective cells depending on what type of template is entered into the far left column.

{{:google-mapper:variable_columns.png?800|}}


When you type in a new template (Template1, Template2, etc.) into the second column it changes the heading to help you enter data based on what type of point you would like to use.

You can refer to is master key on what each template needs you to enter in each column.

{{:google-mapper:template_master_key.png?800|}}

**Additional Columns Explained:**

**Template:** The template is what controls your inputs look like in the pop up window when you click on your pin in google maps

**Title:** This will be what you want to name your point

**Subtitle:** This is your subtitle.

**Paragraph 1 Text:** This is where you can type block text about your point.

**Paragraph 2 Text:** This only appears for Template 1 and 2 but you can put additional text here. 

**Image URL:** This is only available for Template 3 and 4 and this is where you put a link to an Image that you want to be displayed. 

**Image Width and Image Height:** This is where you can specify the desired size of your image in pixels ex.: 300 X 400.

**Paragraph Text:** This is available for templates 2-4 to allow you to type block text for your images or links.

**Link URL:** This allows you in every template to include a link to another site. 

**Link Text:** The link Text will be how the Link URL is displayed within your pop up window to shorten it, just like how a hyperlink is used. 

**Video Embed Code:** This will allow you to Embed a video into your popup window from the web, such as Youtube or Vimeo. Make sure you use a Embed code and not a link. A link will work as well, but it will not allow the video to play directly from your point in google maps.

**Other Embed Code:** This does not work in google maps.

=====Adding or Removing Rows=====

So Click “Spreadsheet Mapper” at the top, and then click, “Remove some rows.”

{{:google-mapper:spreadsheet_mapper_-_remove_some_rows.png?600|}}

An an authorization screen will pop up, click "Ok".

{{:google-mapper:authorization.png?400|}}

Another screen will pop up and click "Accept".

{{:google-mapper:accept.png?400|}}

Remove the desired amount of rows.

{{:google-mapper:remove_500.png?400|}}

This process will take a moment to delete the rows and then to process the table. 

Sometimes Google Drive does not process the spreadsheet correctly so it is recommended to run the repair tool as well. 

To run the repair tool, go back to Spreadsheet Mapper and Click "Repair Rows & Formulas."

{{:google-mapper:spreadsheet_mapper_repair.png?600|}}


A confirmation box will pop up, click "OK"

{{:google-mapper:repair_confirm.png?300|}}

Once google drive has repaired the Rows and formulas another box will pop up to tell you that repair is completed. Click "OK" to close the box. 

{{:google-mapper:repair_completed.png?300|}}


===== Embedding in WordPress =====

Open your spreadsheet map in google maps and click the "chain" icon at the top left.

{{:google-mapper:embed_step_one.png?600|}}


In the pop up window copy the embed code.

{{:google-mapper:embed_step_two.png?600|}}


Open your Wordpress dashboard and make a new post. Change your post type from "Visual" to "Text" in the top left corner. This will make WordPress interpret your link as code and display it properly. You can also edit how large your map appears in your post by adjusting the Width and Height code at the beginning of the embed code. 

{{:google-mapper:adding_to_wordpress.png?800|}}





===== Tips: =====

Be Patient because it will take Google drive and the codes in the spreadsheets a few moments to process your changes.

Do not forget to republish your edits after you make them! Refer to Publishing to the web section


===== Errors: =====


==== Script Error: ====



First thing to do is to follow the steps from above In the "Detour" above, delete and repair rows. 
Then sign out of Google drive and close the browser.
Wait 10-20 minutes. Sometimes there is a residual error built up in the google server. This is most likely due to a self defense mechanism in the code of the server to keep a user from crashing the server by using up too much computing power.