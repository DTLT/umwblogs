{{indexmenu_n>1}}

#Using the Spreadsheet Mapper

====Getting the Mapper Template====

1)  Go to [[http://drive.google.com|Google Drive]] and sign in with your Google username and password. If you don't already have a Google account, you will need to [[https://accounts.google.com/signup|create one]].

2)  From the Google Drive [[http://drive.google.com/templates|Templates gallery]], search for UMW, and find the Spreadsheet Mapper template your course is using. If there is not a customized template for your specific course, use the template called "UMW Spreadsheet Mapper." You can also find [[google-mapper:google-mapper|a list of customized templates]] on this wiki.

3)  Once you have found the right template, click the "Use this template" button, and the template will be copied into your Google Drive account. When it is done copying, the template will be opened in your browser and you can begin working immediately.

====Initial Setup====

1)  The template will automatically open to the MapMetaData tab. Change the information in the "Basic Information" section to describe the project you are working on.

2)  To make the data from this map accessible via the web, you will need to publish it. From the top menu, click File -> Publish to Web.

[{{ :google-mapper:file_publish_to_web.png?450 |}}]

3)  Another window will pop up. Uncheck the Automatically republish when changes are made box, and click Start Publishing now. 

4)  Remember, you will need to manually republish this spreadsheet after you make updates. You can do that by returning to this screen, and clicking the Republish now button.

====Entering Data====

To begin entering data, click the tab along the bottom of the screen called PlacemarkData. This is the worksheet where all of the data for your map lives. Each row will create a single placemark (i.e. a point on your map). Several sample placemarks have been included in the template to more accurately The data is broken down into two sections: static columns, and variable columns.

NOTE: To remove the sample placemarks, delete the content from each cell. DO NOT delete rows from the spreadsheet, as this will cause errors.

===Static Columns===

All placemarks have the same static columns, regardless of which template will be used to display the placemark. These columns are:

  * **Folder Name:** (optional) helps organize placemarks into a collapsible folder.
  * **Placemark Name:** the name of the location you are mapping.
  * **Latitude and Longitude:** the geocoordinates of the location you are mapping.
  * **Address:** the street address of the location you are mapping.

===Variable Columns===

The variable columns for each placemark are defined by the display template being used for each placemark. For a quick summary of columns used in a particular template, check the master key near the top of the PlacemarkData worksheet. 

To make data entry easier, type the name of the desired template into cell I9 of the spreadsheet. This will change the yellow column headers, so you can easily see which data should go into which cell for a particular placemark. 

To identify which template should be used to display a placemark, type the name of the template into the row where it intersects with column H.

[{{ :google-mapper:template-fields.png?600 | }}]

===Best Practices===

  * Link Text refers to the text visitors will click to visit the link, while Link URL refers to the destination they'll be taken upon clicking.
  * Image URLs need to be a direct link to an image, ending in .jpg, .png, or another image extension. If the image you want to use is on your computer, you can upload it to an image hosting service like [[http://imgur.com|Imgur]], [[http://photobucket.com|Photobucket]], or [[http://flickr.com|Flickr]].
  * All images should be less than 200 pixels in height.
  * Use geocoordinates (latitude and longitude) instead of street addresses when possible. Using street addresses will make your map much slower to load.
  * Geocoordinates can often be found through a simple Google search (e.g. "UMW coordinates"). You can also navigate to the location you're mapping in Google Maps, right click on the spot you want to retrieve geocoordinates for, and then click “What's here?” in the pop up menu. The Latitude and Longitude will be displayed in the search bar at the top.
  * Latitude and longitude must be entered into this spreadsheet as decimals, using positive and negative numbers to denote direction. North latitudes and east longitudes are positive numbers; south latitudes and west longitudes are negative numbers.

[{{ :google-mapper:lat-long.png |}}]


=====Adding or Removing Rows=====

So Click “Spreadsheet Mapper” at the top, and then click, “Remove some rows.”

{{:google-mapper:spreadsheet_mapper_-_remove_some_rows.png?600|}}

An an authorization screen will pop up, click "Ok".

{{:google-mapper:authorization.png?400|}}

Another screen will pop up and click "Accept".

{{:google-mapper:accept.png?400|}}

Remove the desired amount of rows.

{{:google-mapper:remove_500.png?400|}}

This process will take a moment to delete the rows and then to process the table. 

Sometimes Google Drive does not process the spreadsheet correctly so it is recommended to run the repair tool as well. 

To run the repair tool, go back to Spreadsheet Mapper and Click "Repair Rows & Formulas."

{{:google-mapper:spreadsheet_mapper_repair.png?600|}}


A confirmation box will pop up, click "OK"

{{:google-mapper:repair_confirm.png?300|}}

Once google drive has repaired the Rows and formulas another box will pop up to tell you that repair is completed. Click "OK" to close the box. 

{{:google-mapper:repair_completed.png?300|}}


===== Embedding in WordPress =====

Open your spreadsheet map in google maps and click the "chain" icon at the top left.

{{:google-mapper:embed_step_one.png?600|}}


In the pop up window copy the embed code.

{{:google-mapper:embed_step_two.png?600|}}


Open your Wordpress dashboard and make a new post. Change your post type from "Visual" to "Text" in the top left corner. This will make WordPress interpret your link as code and display it properly. You can also edit how large your map appears in your post by adjusting the Width and Height code at the beginning of the embed code. 

{{:google-mapper:adding_to_wordpress.png?800|}}





===== Tips: =====

Be Patient because it will take Google drive and the codes in the spreadsheets a few moments to process your changes.

Do not forget to republish your edits after you make them! Refer to Publishing to the web section


===== Errors: =====


==== Script Error: ====



First thing to do is to follow the steps from above In the "Detour" above, delete and repair rows. 
Then sign out of Google drive and close the browser.
Wait 10-20 minutes. Sometimes there is a residual error built up in the google server. This is most likely due to a self defense mechanism in the code of the server to keep a user from crashing the server by using up too much computing power.